<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dashboard ‚Äì Parking IoT</title>
  <link rel="stylesheet" href="dashboard.css">

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>

<body>

<div class="topbar">
  <div class="topbar-left">
    <span class="logo">üè¢ Smart Parking System</span>
    <span class="subtitle">H·ªá th·ªëng qu·∫£n l√Ω b√£i ƒë·ªó xe th√¥ng minh</span>
  </div>
  <div class="topbar-right">
    <div class="stats">
      <div class="stat-item available">
        <span class="stat-num" id="availableCount">0</span>
        <span class="stat-label">Ch·ªó tr·ªëng</span>
      </div>
      <div class="stat-item occupied">
        <span class="stat-num" id="occupiedCount">0</span>
        <span class="stat-label">ƒêang ƒë·ªó</span>
      </div>
      <div class="stat-item booked">
        <span class="stat-num" id="bookedCount">0</span>
        <span class="stat-label">ƒê√£ ƒë·∫∑t</span>
      </div>
    </div>
    <button class="logout-btn" onclick="logout()">ƒêƒÉng xu·∫•t</button>
  </div>
</div>

<div class="parking-lot-container">
  <div class="parking-lot">
    
    <!-- Entrance/Exit -->
    <div class="entrance">
      <div class="barrier-gate">
        <div class="gate-sign">‚¨áÔ∏è ENTRANCE</div>
        <div class="barrier-line"></div>
      </div>
    </div>

    <!-- Road -->
    <div class="main-road">
      <div class="road-marking"></div>
    </div>

    <!-- Left Side Parking Slots -->
    <div class="parking-row left-row">
      <div class="parking-slot empty" id="Slot01Box" onclick="openBooking('Slot01')">
        <div class="slot-number">A1</div>
        <div class="car-shape" id="Slot01Car">
          <div class="car-front"></div>
          <div class="car-body"></div>
          <div class="car-back"></div>
        </div>
        <div class="slot-info">
          <div id="Slot01Status" class="slot-status">TR·ªêNG</div>
          <div id="Slot01Timer" class="slot-timer"></div>
        </div>
      </div>

      <div class="parking-slot empty" id="Slot02Box" onclick="openBooking('Slot02')">
        <div class="slot-number">A2</div>
        <div class="car-shape" id="Slot02Car">
          <div class="car-front"></div>
          <div class="car-body"></div>
          <div class="car-back"></div>
        </div>
        <div class="slot-info">
          <div id="Slot02Status" class="slot-status">TR·ªêNG</div>
          <div id="Slot02Timer" class="slot-timer"></div>
        </div>
      </div>

      <div class="parking-slot empty" id="Slot03Box" onclick="openBooking('Slot03')">
        <div class="slot-number">A3</div>
        <div class="car-shape" id="Slot03Car">
          <div class="car-front"></div>
          <div class="car-body"></div>
          <div class="car-back"></div>
        </div>
        <div class="slot-info">
          <div id="Slot03Status" class="slot-status">TR·ªêNG</div>
          <div id="Slot03Timer" class="slot-timer"></div>
        </div>
      </div>
    </div>

    <!-- Right Side Parking Slots -->
    <div class="parking-row right-row">
      <div class="parking-slot empty disabled">
        <div class="slot-number">B1</div>
        <div class="car-shape">
          <div class="car-front"></div>
          <div class="car-body"></div>
          <div class="car-back"></div>
        </div>
        <div class="slot-info">
          <div class="slot-status">COMING SOON</div>
        </div>
      </div>

      <div class="parking-slot empty disabled">
        <div class="slot-number">B2</div>
        <div class="car-shape">
          <div class="car-front"></div>
          <div class="car-body"></div>
          <div class="car-back"></div>
        </div>
        <div class="slot-info">
          <div class="slot-status">COMING SOON</div>
        </div>
      </div>

      <div class="parking-slot empty disabled">
        <div class="slot-number">B3</div>
        <div class="car-shape">
          <div class="car-front"></div>
          <div class="car-body"></div>
          <div class="car-back"></div>
        </div>
        <div class="slot-info">
          <div class="slot-status">COMING SOON</div>
        </div>
      </div>
    </div>

    <!-- Exit -->
    <div class="exit">
      <div class="barrier-gate">
        <div class="barrier-line"></div>
        <div class="gate-sign">‚¨ÜÔ∏è EXIT</div>
      </div>
    </div>

  </div>
</div>

<!-- POPUP -->
<div id="bookDialog" class="dialog">
  <h3>ƒê·∫∑t ch·ªó ƒë·∫≠u xe</h3>
  <p>Ch·ªçn ng√†y v√† gi·ªù ƒë·∫∑t ch·ªó ƒë·∫øn</p>

  <div class="datetime-picker">
    <div class="input-row">
      <div class="input-col">
        <label>Ng√†y:</label>
        <input type="date" id="bookDate">
      </div>
      <div class="input-col">
        <label>Gi·ªù:</label>
        <input type="time" id="bookTime" value="12:00">
      </div>
    </div>
  </div>

  <div class="booking-info">
    <span id="bookingDuration"></span>
  </div>

  <div class="dialog-buttons">
    <button class="btn-confirm" onclick="confirmBooking()">X√°c nh·∫≠n</button>
    <button class="btn-cancel" onclick="closeDialog()">H·ªßy</button>
  </div>
</div>

<!-- PAYMENT DIALOG -->
<div id="paymentDialog" class="dialog payment-dialog">
  <h3>üí≥ Thanh to√°n</h3>
  
  <div class="payment-details">
    <div class="payment-row">
      <span class="label">Ph√≠ c∆° b·∫£n:</span>
      <span class="value">5,000 ƒë</span>
    </div>
    <div class="payment-row">
      <span class="label">Th·ªùi gian ƒë·ªó:</span>
      <span class="value" id="paymentDuration">0 gi·ªù</span>
    </div>
    <div class="payment-row">
      <span class="label">Ph√≠ theo gi·ªù:</span>
      <span class="value" id="paymentHourlyFee">0 ƒë</span>
    </div>
    <div class="payment-divider"></div>
    <div class="payment-row total">
      <span class="label">T·ªïng c·ªông:</span>
      <span class="value" id="paymentTotal">5,000 ƒë</span>
    </div>
  </div>

  <div class="qr-container">
    <div class="qr-label">Qu√©t m√£ QR ƒë·ªÉ thanh to√°n</div>
    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=SmartParking-Payment" 
         alt="QR Code" class="qr-code">
    <div class="qr-note">Qu√©t m√£ b·∫±ng ·ª©ng d·ª•ng ng√¢n h√†ng</div>
  </div>

  <div id="paymentProcessing" class="payment-processing hidden">
    <div class="spinner"></div>
    <p>ƒêang x·ª≠ l√Ω thanh to√°n...</p>
  </div>

  <div id="paymentSuccess" class="payment-success hidden">
    <div class="success-icon">‚úÖ</div>
    <p>Thanh to√°n th√†nh c√¥ng!</p>
    <p class="success-note">ƒêang x√°c nh·∫≠n ƒë·∫∑t ch·ªó...</p>
  </div>

  <div class="dialog-buttons">
    <button class="btn-confirm" onclick="processPayment()">T√¥i ƒë√£ thanh to√°n</button>
    <button class="btn-cancel" onclick="closePaymentDialog()">H·ªßy</button>
  </div>
</div>

<!-- BOOKING INFO DIALOG -->
<div id="bookingInfoDialog" class="dialog booking-info-dialog">
  <div class="dialog-header">
    <h3>üÖøÔ∏è Th√¥ng tin ƒë·∫∑t ch·ªó</h3>
    <button class="close-btn" onclick="closeBookingInfo()">‚úï</button>
  </div>
  
  <div class="booking-details">
    <div class="booking-detail-row">
      <div class="detail-icon">üìç</div>
      <div class="detail-content">
        <div class="detail-label">V·ªã tr√≠</div>
        <div class="detail-value" id="infoSlotId">A1</div>
      </div>
    </div>
    
    <div class="booking-detail-row">
      <div class="detail-icon">üë§</div>
      <div class="detail-content">
        <div class="detail-label">Ng∆∞·ªùi ƒë·∫∑t</div>
        <div class="detail-value" id="infoBookedBy">user123</div>
      </div>
    </div>
    
    <div class="booking-detail-row">
      <div class="detail-icon">üìÖ</div>
      <div class="detail-content">
        <div class="detail-label">ƒê·∫∑t l√∫c</div>
        <div class="detail-value" id="infoBookedAt">12/12/2025 10:00</div>
      </div>
    </div>
    
    <div class="booking-detail-row">
      <div class="detail-icon">‚è∞</div>
      <div class="detail-content">
        <div class="detail-label">H·∫øt h·∫°n</div>
        <div class="detail-value" id="infoExpireTime">12/12/2025 18:00</div>
      </div>
    </div>
    
    <div class="booking-detail-row">
      <div class="detail-icon">‚è±Ô∏è</div>
      <div class="detail-content">
        <div class="detail-label">Th·ªùi gian c√≤n l·∫°i</div>
        <div class="detail-value remaining" id="infoRemaining">5 gi·ªù 30 ph√∫t</div>
      </div>
    </div>
    
    <div class="booking-detail-row highlight">
      <div class="detail-icon">üí∞</div>
      <div class="detail-content">
        <div class="detail-label">ƒê√£ thanh to√°n</div>
        <div class="detail-value price" id="infoPayment">14,000 ƒë</div>
      </div>
    </div>
  </div>
  
  <div class="dialog-buttons">
    <button class="btn-danger" onclick="confirmCancelBooking()">üóëÔ∏è H·ªßy ƒë·∫∑t ch·ªó</button>
    <button class="btn-cancel" onclick="closeBookingInfo()">ƒê√≥ng</button>
  </div>
</div>

<!-- CONFIRM DIALOG -->
<div id="confirmDialog" class="dialog confirm-dialog">
  <div class="confirm-icon">‚ö†Ô∏è</div>
  <h3 id="confirmTitle">X√°c nh·∫≠n</h3>
  <p id="confirmMessage">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán thao t√°c n√†y?</p>
  <div class="dialog-buttons">
    <button class="btn-danger" id="confirmYes">X√°c nh·∫≠n</button>
    <button class="btn-cancel" id="confirmNo">H·ªßy</button>
  </div>
</div>

<!-- NOTIFICATION TOAST -->
<div id="notificationToast" class="notification-toast">
  <div class="toast-icon" id="toastIcon">‚úÖ</div>
  <div class="toast-content">
    <div class="toast-title" id="toastTitle">Th√†nh c√¥ng</div>
    <div class="toast-message" id="toastMessage">Thao t√°c ƒë√£ ƒë∆∞·ª£c th·ª±c hi·ªán</div>
  </div>
</div>

<script src="firebase-config.js"></script>
<script src="dashboard.js"></script>

</body>
</html>
